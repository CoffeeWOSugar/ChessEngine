<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Chess Engine – Tests</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body class="tests-body">
    <header class="app-header">
      <h1 class="app-header__title">Engine Tests</h1>
      <button class="header-btn" onclick="goHome()">← Back</button>
    </header>

    <main class="app-main">
      <p class="text-muted">Run built-in Perft tests (C++ engine correctness)</p>

      <button id="runBtn" class="btn btn-primary tests-run-btn">Run Tests</button>

      <div id="status" class="tests-status mt-2">Idle</div>
      <div id="output" class="output-box tests-output"></div>
    </main>

    <script>
      function goHome() { window.location.href = "/"; }

      async function runTests() {
        const s = document.getElementById("status");
        const o = document.getElementById("output");
        s.textContent = "Running...";
        s.className = "tests-status text-muted";
        o.textContent = "";

        try {
          let res = await fetch("/api/run-tests", { method: "POST" });
          let data = await res.json();
          o.textContent = data.output || "";

          if (data.success) {
            s.textContent = "✔ Tests passed";
            s.className = "tests-status ok";
          } else {
            s.textContent = "✘ Tests FAILED";
            s.className = "tests-status fail";
          }
        } catch (e) {
          s.textContent = "Error: " + e.message;
          s.className = "tests-status fail";
        }
      }

      runBtn.addEventListener("click", runTests);
    </script>
  </body>
</html>
